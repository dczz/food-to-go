# FOOD TO GO 

### 背景
本项目为 《Pojos in Action》 读书笔记。

### 概述
项目试图解决的问题相关的一些背景，以及程序的总体机构。
Food To Go Inc 的主营业务是将餐馆接到的食物订单送到顾客的住处和办公室。Food To Go的创办者决定构建一个基于J2EE的应用程序来运营公司业务。这个应用程序支持下列客户：
 * 顾客：下订单以及查看订单状态
 * 客服：处理来自顾客关于订单的询问
 * 餐馆：提供菜单，准备订单
 * 调度员：将订单分配给司机
 * 司机：取到来自餐馆的的订单，并交付订单

### 需求
经过大量的讨论，确定了如下场景，以描述订单如何在整个系统里的流动。事件先后顺序如下所示：

1. 顾客通过网站下订单。
2. 系统（通过传真或email）发送订单到餐馆
3. 餐馆确认收到的订单
4. 调度员将订单直拍给司机
5. 系统向接受指派的司机发送通知
6. 司机选取来自餐馆的订单，并将自己选取的订单告知系统
7. 司机将订单交付给顾客，并告知系统订单已交付。

除了提出场景以掌握英语哦那个程序到底是如何运作的，发开人员和业务专家还将应用程序需求分解成一组用例。
由于使用迭代和增量方法开发应用程序。还决定将调度员和司机相关用例的实现推迟到后期迭代，在第一次迭代中只处理下来用例：

- 下单订：描述顾客怎样下订单
- 查看订单：描述客服怎样查看订单
- 发送订单到餐馆
- 确认订单：描述餐厅是怎样确认收到订单的
- 修改订单：描述客服怎样才能修改订单

### 设计决策

## 组织业务逻辑
## 封装业务逻辑
## 访问数据库
## 处理并发更新
## 处理离线并发（分布式）
## 总体决策小结
|决策|选项|
|----|----|
|业务逻辑的组织策略|领域模型，必要时使用事务脚本辅助|
|业务逻辑的封装策略|POJO facade|
|持久化策略|JPA|
|在线并发策略|乐观锁|
|离线并发策略|分布式锁|

## 用例决策

"下订单"用例：
- 顾客输入送货地址和时间。系统首先验证送货时间处于将来，并确定是少有一家餐馆能为这次送货信息提供服务。然后，系统将送货信息更新到代办订单，并显示一个可选餐馆的列表。
- 顾客选择一家餐馆。系统将这家暗管的信息更新到待办订单，并显示选定餐馆的菜单。
- 顾客输入每个菜单条目的数量。系统将数量更新到待办订单，并显示更新后的待办订单。
- 顾客输入付款信息（信用卡信息或账单地址）。系统将付款信息更新至待办订单，并显示待办订单的总额、税款和找零。
- 顾客确认自己要下订单。系统认可信用卡后，创建订单，并显示订单确认信息，其中包含订单号。

"查看订单"用例：
- 客服输入搜索条件，系统显示与搜索条件匹配的订单，客服可以撤销和修改订单。

"发送订单到餐厅"用例：
- 距预定送货时间X分钟之后，系统将订单email或传真至餐馆。

"确认订单"用例：
- 系统显示订单已发送到餐馆。餐馆的接单员接受或拒绝订单。系统显示确认页面，接单员确认/拒绝订单。系统将订单状态修改成“ACCEPTED”或者“REJECTED”

"修改订单"用例：
- 客服选择订单进行编辑，系统锁定并显示订单。客服更新数量以及送货地址和时间。系统显示更新后的订单。客服保存自己的修改。系统更新并解锁订单。